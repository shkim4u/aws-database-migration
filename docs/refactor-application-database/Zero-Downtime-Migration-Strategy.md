대량의 레코드를 가진 데이터베이스 테이블을 마이그레이션할 때, 특히 무중단(mzero downtime) 상태를 유지하려는 경우 몇 가지 중요한 고려 사항이 있습니다. AWS DMS(AWS Database Migration Service)와 같은 도구를 사용하여 데이터 마이그레이션을 수행할 때, 일반적으로 **Full Load**와 **Change Data Capture(CDC)**의 두 가지 주요 단계가 있습니다.

### 무중단 데이터 마이그레이션의 개념

1. **Full Load 단계**:
    - 이 단계에서는 소스 데이터베이스의 모든 데이터를 타겟 데이터베이스로 복사합니다. 이 작업은 데이터 양에 따라 상당한 시간이 걸릴 수 있습니다.
    - 이 단계 동안 데이터베이스는 계속해서 사용될 수 있으며, DMS는 변경 사항을 기록하지 않습니다. 즉, Full Load가 진행되는 동안의 변경 사항은 반영되지 않습니다.

2. **Change Data Capture(CDC) 단계**:
    - Full Load가 완료된 후, DMS는 소스 데이터베이스에서 발생하는 모든 데이터 변경 사항(삽입, 업데이트, 삭제)을 캡처하여 타겟 데이터베이스로 전달합니다.
    - 이 단계는 데이터의 지속적인 동기화를 위해 사용됩니다.

### 무중단 마이그레이션을 위한 전략

애플리케이션을 중단하지 않고 대량의 데이터베이스 테이블을 마이그레이션하려면, 데이터가 변경될 수 있는 환경에서도 무중단 상태를 유지해야 합니다. 다음은 이를 달성하기 위한 전략입니다.

1. **Full Load와 CDC를 병행하여 수행**:
    - Full Load가 진행될 때 이미 CDC를 활성화하여 변경 사항을 캡처하고 기록할 수 있습니다.
    - DMS에서는 Full Load가 완료된 후 CDC 단계로 자동으로 전환되어, Full Load 동안 발생한 변경 사항을 추적합니다. 이를 통해 Full Load가 끝난 후 모든 데이터 변경 사항이 타겟 데이터베이스로 전달되므로 데이터 일관성이 유지됩니다.

2. **Full Load 과정에서의 데이터 변경 허용**:
    - 애플리케이션이 데이터베이스에 계속 접근할 수 있게 하고, Full Load 동안 발생한 데이터 변경 사항은 CDC로 캡처하도록 합니다. 이를 통해 Full Load가 완료된 후, CDC가 누락된 변경 사항을 타겟 데이터베이스에 적용하여 데이터 일관성을 유지할 수 있습니다.
    - 이 방법은 Full Load 동안 소스 데이터베이스가 변경될 가능성을 감안하므로 애플리케이션의 가용성을 유지할 수 있습니다.

3. **CDC 성능 최적화**:
    - Full Load가 완료된 후의 CDC 단계는 소스 데이터베이스와 타겟 데이터베이스 간의 데이터 동기화를 유지하는 핵심 요소입니다. CDC 단계의 성능을 최적화하여 변경 사항이 실시간에 가깝게 타겟으로 전달되도록 하는 것이 중요합니다.
    - 이를 위해 충분한 네트워크 대역폭과 타겟 데이터베이스의 성능을 확보하는 것이 필요합니다.

4. **최종 전환 및 테스트**:
    - 데이터 마이그레이션이 완료된 후, 타겟 데이터베이스로의 전환을 최종화하기 위해 일시적으로 애플리케이션을 중단할 수도 있습니다. 이 경우 중단 시간은 매우 짧게 유지할 수 있습니다.
    - 전환 전에 충분한 테스트를 통해 타겟 데이터베이스가 정확하게 동기화되고 동작하는지 확인해야 합니다.

### 결론

- 애플리케이션을 중단하지 않고 대량의 데이터를 마이그레이션하는 것은 도전적인 작업이지만, 적절한 전략을 통해 무중단 상태를 유지할 수 있습니다.
- Full Load와 CDC를 병행하여 사용하면, 데이터 변경을 허용하면서도 마이그레이션을 진행할 수 있습니다. 이는 Full Load 동안 발생한 변경 사항이 CDC를 통해 적절히 처리되기 때문입니다.
- 성능 최적화와 충분한 테스트는 무중단 데이터 마이그레이션을 성공적으로 수행하는 데 필수적입니다.

따라서, 애플리케이션의 무중단을 달성하면서 데이터베이스 마이그레이션을 수행하는 것은 가능합니다. 이를 위해 적절한 도구와 전략을 사용하여 Full Load와 CDC를 효율적으로 관리해야 합니다.
